<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="description" content="{{ description or site.description }}">
  <title>{{ title or site.title }}</title>
  <script>
    /* Early theme paint */
    (function () {
      try {
        let t = localStorage.getItem('theme');
        if (!t) t = matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
        document.documentElement.dataset.theme = t;
      } catch(e){}
    })();
  </script>
  <style>
    /* ---------- CSS Variables ---------- */
    :root {
      --bg: #fffed7ff;
      --text: #222;
      --border: #eee;
      --footer-bg: #fdffe8ff;
      --footer-text: #555;
      --footer-link-bg: #202224ff;
      --header-bg: #fff9c5ff;
      --header-text: #303132ff;
      --header-link-bg: #f5d693ff;
      --link: #222;
      --link-hover: #7e7e7eff;
      --list-border: #f0f0f0;
      --decoration-color: #212121ff;
      --ease: 0.25s;
      --max-width: 600px;
    }
    [data-theme="dark"] {
      --bg: #101112ff;
      --text: #eaeaea;
      --border: #687075;
      --footer-bg: #0c0c0cff;
      --footer-text: #9fa3a5ff;
      --footer-link-bg: #393d3eff;
      --header-bg: #0c0c0cff;
      --header-text: #dadadaff;
      --header-link-bg: #393d3eff;
      --link: #eaeaea;
      --link-hover: #a5ff5b;
      --list-border: #23272a;
      --decoration-color: #c8c8c8ff;
    }

    /* ---------- Base ---------- */
    * { box-sizing:border-box; }
    html,body { height:100%; margin:0; padding:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,Ubuntu,sans-serif; background:var(--bg); color:var(--text); }
    body { min-height:100vh; display:flex; flex-direction:column; }
    a { color:var(--link); text-decoration:var(--decoration-color) solid underline; transition:color var(--ease); }
    a:hover { color:var(--link-hover); }
    h1,h2,h3 { margin:1.5rem 0 1rem; font-weight:500; }
    p { margin:1rem 0; }
    ul { list-style:none; padding:0; margin:0; }
    li { margin:.75rem 0; padding:.5rem 0; border-bottom:1px solid var(--list-border); }
    li:last-child { border-bottom:none; }

    /* ---------- Layout Containers ---------- */
    .container { max-width:var(--max-width); width:100%; margin:0 auto; padding:1.5rem 1rem; }
    main.container { flex:1 0 auto; }
    header,footer { background:none; color:var(--text); text-align:center; border-bottom:1px solid var(--border); transition:background var(--ease),color var(--ease),border-color var(--ease); }
    header h1 a { text-decoration:none; }

    /* ---------- Header Navigation ---------- */
    nav ul { display:flex; gap:1.5rem; justify-content:center; padding:0; margin:.5rem 0 0; }
    nav ul li { border:none; margin:0; padding:0; }
    .header-bar { display:flex; align-items:center; justify-content:space-between; height:50px; padding:0 1rem; }
    .actions { display:flex; gap:.5rem; align-items:center; }
    #menu-toggle,#theme-toggle {
      display:inline-flex; background:none; border:1px solid var(--border); padding:.3em .65em;
      border-radius:4px; cursor:pointer; font-size:1.05em; transition:background var(--ease),color var(--ease),border-color var(--ease);
    }
    #menu-toggle { display:none; }

    /* ---------- Mobile Fullscreen Menu ---------- */
    #menu-overlay {
      position:fixed; inset:0; display:none; background:var(--bg); z-index:1000; padding:0 12%;
    }
    #menu-overlay.open { display:flex; flex-direction:column; justify-content:center; align-items:flex-start; }
    #menu-overlay ul { max-width:480px; width:100%; }
    #menu-overlay li { display:flex; gap:.75rem; margin:.45rem 0; padding:0; border:none; }
    #menu-overlay li::before { content:"//"; opacity:.6; font-size:1.9rem; line-height:1.25; }
    #menu-overlay a { font-size:1.9rem; line-height:1.25; color:var(--text); text-decoration:none; }

    /* ---------- Footer ---------- */
    footer { border-top:1px solid var(--border); border-bottom:none; margin-top:2rem; padding:1.5rem 0 1rem; font-size:.95em; background:var(--footer-bg); color:var(--footer-text); letter-spacing:.01em; }
    footer a { color:var(--footer-text); text-decoration:none; padding:0 .2em; border-radius:2px; transition:background var(--ease),color var(--ease); }
    footer a:hover { background:var(--footer-link-bg); color:var(--link-hover); }

    .footer-layout { display:grid; grid-template-columns:1fr auto; grid-template-rows:auto auto; align-items:start; gap:0 3rem; min-height:130px; }
    .footer-brand { font-weight:600; font-size:1.05rem; grid-column:1; grid-row:1; text-align:left; }
    .footer-brand a { text-decoration:none; color:var(--link); }
    .footer-groups { grid-column:2; grid-row:1 / span 2; display:grid; grid-auto-flow:column; gap:2.5rem; text-align:left; }
    .footer-groups li { margin:0 0 .4rem; border:none; padding:0; }
    .footer-groups a { display:inline-block; padding:.15rem .35rem; border-radius:4px; }
    .footer-groups a:hover { background:var(--footer-link-bg); color:var(--link-hover); }
    .footer-copy { grid-column:1; grid-row:2; align-self:end; font-size:.75rem; opacity:.65; text-align:left; margin-top:1rem; }

    /* ----------- Header ----------- */
    header { background: var(--header-bg); color: var(--header-text); border-bottom: 1px solid var(--border); }
    header a { color: var(--header-text); text-decoration: none; padding: 0 .2em; border-radius: 2px; transition: background var(--ease), color var(--ease); }
    header a:hover { background: var(--header-link-bg); color: var(--link-hover); }
    .site-header .header-bar { background: transparent; }
    .site-header h1 a { color: var(--header-text); }

    /* ---------- Utilities ---------- */
    .excerpt { margin:.25rem 0 0; font-size:.8em; color:var(--footer-text); line-height:1.3; }
    .indent { padding-left:1rem; }
    .list-pad ul { padding-left:1rem; }

    /* ---------- Responsive ---------- */
    @media (max-width:700px) {
      nav.desktop-nav { display:none; }
      #menu-toggle { display:inline-block; }
    }
    @media (max-width:640px) {
      .footer-layout { grid-template-columns:1fr; grid-template-rows:auto auto auto; gap:1rem 0; min-height:0; }
      .footer-groups { grid-column:1; grid-row:2; grid-auto-flow:row; gap:1.25rem; }
      .footer-copy { grid-row:3; margin-top:.25rem; }
    }
    @media (max-width:600px) {
      .container { padding:1rem .5rem; }
      nav ul { gap:1rem; }
      .indent { padding-left:.75rem; }
    }
    @media (max-width:400px) {
      nav ul { flex-direction:column; gap:.5rem; }
      header .container, footer .container { padding-left:.2rem; padding-right:.2rem; }
      .indent { padding-left:.5rem; }
    }
  </style>
</head>
<body>
  {% include "components/header.njk" %}
  <main class="container">
    {% block content %}{{ content | safe }}{% endblock %}
  </main>
  {% include "components/footer.njk" %}

  <script>
    (function(){
      const root=document.documentElement;
      const themeBtn=document.getElementById("theme-toggle");
      if(themeBtn){
        const apply=t=>{root.dataset.theme=t;localStorage.setItem("theme",t)};
        themeBtn.onclick=()=>apply(root.dataset.theme==="dark"?"light":"dark");
      }
      const menuBtn=document.getElementById("menu-toggle");
      const overlay=document.getElementById("menu-overlay");
      function toggle(){
        const open=overlay.classList.toggle("open");
        menuBtn.setAttribute("aria-expanded",open);
        overlay.setAttribute("aria-hidden",!open);
        document.body.style.overflow=open?"hidden":"";
      }
      if(menuBtn&&overlay){
        menuBtn.addEventListener("click",toggle);
        overlay.addEventListener("click",e=>{ if(e.target===overlay) toggle(); });
        addEventListener("keydown",e=>{ if(e.key==="Escape"&&overlay.classList.contains("open")) toggle(); });
      }
    })();
  </script>
</body></html>